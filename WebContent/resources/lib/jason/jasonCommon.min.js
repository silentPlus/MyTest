/*
**jasonWap-UI-Plugins**
**jasonWap UI基础插件库**
**author:jasonYang**
*/var jason=af;(function(C){C.fn.jasonScrollbar=function(D){return new A(D,this)};var B=new Array();var A=function(F,E){var D=this;D.element=C(E);D.opt={moveY:0,maxMoveY:0};D.scrollNode=null;D.barNode=null;D.barNodeHeight=0;D.barNodeLock=0;D.param=C.extend({},{isShowBar:true},F);D.start();B.push(D)};A.prototype={start:function(){var O=this,E=this.element,L=0,P,M;var F=E.height();if(F.indexOf("%")>=0||isNaN(F)){var D=E.parent().height();F=(D>window.innerHeight?window.innerHeight:D)*parseFloat(F.replace("%",""))/100}var J=false;if(E.css({"overflow":"hidden","height":F+"px"}).children().eq(0).attr("scrollbarBox")!="jasonScrollbar"){E.html('<div scrollbarBox="jasonScrollbar" style="width:100%;">'+E.html()+"</div>");J=true}var K=E.children().eq(0);O.scrollNode=K;O.opt.maxMoveY=F-K.height();O.opt.maxMoveY=O.opt.maxMoveY>0?0:O.opt.maxMoveY;if(O.param.isShowBar){var N=E.css("position");if(N!="absolute"&&N!="fixed"){E.css("position","relative")}if(J){var H=document.createElement("div");E.append(H);var G=O.barNode=C(H);G.attr("barNode","yes")}else{var G=O.barNode=E.find("[barNode]");E.unbind("touchstart touchmove touchend")}var I=F*F/K.height();I=I>F?F:I;G.css({"position":"absolute","top":"0","right":"2px","width":"5px","height":I+"px","background-color":"#000","opacity":"0.3","border-radius":"5px","display":"none"});O.barNodeHeight=G.height()}E.bind("touchstart",function(Q){Q.stopPropagation();K.css({"-webkit-transition-duration":"0s","transition-duration":"0s"});O.barNodeLock=1;if(O.param.isShowBar){G.css({"-webkit-transition-duration":"0ms","transition-duration":"0ms"});G.css("opacity","0.3");G.show()}M=Q.touches[0].pageY;L=Q.touches[0].pageY-O.opt.moveY;P=Q.timeStamp||Date.now()});E.bind("touchmove",function(Q){Q.preventDefault();Q.stopPropagation();O.barNodeScolling();var R=Q.touches[0].pageY;O.opt.moveY=R-L;K.cssTranslate("0,"+O.opt.moveY+"px");var S=Q.timeStamp||Date.now();if(S-P>300){M=R;P=S}});E.bind("touchend",function(R){var T=(R.changedTouches[0].timeStamp||Date.now())-P;var S=R.changedTouches[0].pageY-M;if(T<300&&Math.abs(S)>10&&O.opt.moveY<0&&O.opt.moveY>O.opt.maxMoveY){var Q=O.momentum(S,T);O.opt.moveY+=Q.dist;if(O.opt.moveY>0){O.opt.moveY=20}else{if(O.opt.moveY<O.opt.maxMoveY){O.opt.moveY=O.opt.maxMoveY-20}}K.css({"-webkit-transition-duration":Q.time+"ms","transition-duration":Q.time+"ms"});K.cssTranslate("0,"+O.opt.moveY+"px");O.barNodeScolling(Q.time);O.rebound(Q.time)}else{O.rebound()}})},rebound:function(D){var E=this;var F=0;if(!D){D=0}setTimeout(function(){$tmp=E.scrollNode;$tmp.css({"-webkit-transition-duration":"0.2s","transition-duration":"0.2s"});if(E.opt.moveY>0){$tmp.cssTranslate("0,0");E.opt.moveY=0;F=300}else{if(E.opt.moveY<E.opt.maxMoveY){$tmp.cssTranslate("0,"+E.opt.maxMoveY+"px");E.opt.moveY=E.opt.maxMoveY;F=300}}E.barNodeScolling(F);E.barNodeLock=0;setTimeout(function(){if(!E.barNodeLock&&E.param.isShowBar){var G=E.barNode;G.css({"-webkit-transition-duration":"500ms","transition-duration":"500ms"});G.css("opacity","0");setTimeout(function(){if(!E.barNodeLock){G.hide();G.css({"-webkit-transition-duration":"0ms","transition-duration":"0ms"});G.css("opacity","0.3")}},500)}},F)},D)},momentum:function(H,I){var G=0.001,E=Math.abs(H)/I,F=(E*E)/(2*G),D=E/G;return{dist:H>0?F:-F,time:D}},barNodeScolling:function(E,G){var I=this;if(I.param.isShowBar){var F=I.scrollNode;var D=I.element;var K=I.barNode;if(!E){E=0}var L=I.opt.moveY/(F.height()/D.height());var J=D.height()-5;K.css({"-webkit-transition-duration":E+"ms","transition-duration":E+"ms"});K.cssTranslate("0,"+(L>0?0:L<-J?J:-L)+"px");var H=I.barNodeHeight-(L>0?L:L<-(J-I.barNodeHeight+5)?-(J-I.barNodeHeight+5)-L:0);H=H<5?5:H;K.css("height",H+"px")}}}})(jason);(function(D){var C;D.jasonPopup=D.fn.jasonPopup=function(E){return new B(E)};var A=new Array();var B=function(E){var F=this;F.popupNode=C;F.windowHeight=D.os.android?(window.innerHeight>480?window.innerHeight:480):window.innerHeight;F.isLock=0;F.hasPopupPosition=0;F.isBlurPosition=false;F.opt=D.extend({},{bgStyle:"",boxStyle:"",title:"",titleStyle:"",titleLeftText:"",titleLeftStyle:"",titleLeftCallback:function(){},titleRightText:"",titleRightStyle:"",titleRightCallback:function(){},message:"",btnStyle:"",cancelText:"取消",cancelStyle:"",cancelCallback:function(){},doneText:"确认",doneStyle:"",doneCallback:function(){},cancelOnly:false,noBtn:false,position:"center",height:0.7,duration:300,closeText:"",closeStyle:"",closeCallback:function(){},isScroll:true,onShow:function(){}},E);F.prepend();A.push(F)};B.fn=B.prototype={prepend:function(){var e=this;var i=e.opt.bgStyle,Q=e.opt.boxStyle,R=e.opt.title,W=e.opt.titleStyle,G=e.opt.titleLeftText,O=e.opt.titleLeftStyle,F=e.opt.titleLeftCallback,J=e.opt.titleRightText,M=e.opt.titleRightStyle,Z=e.opt.titleRightCallback,f=e.opt.message,V=e.opt.btnStyle,Y=e.opt.cancelText,d=e.opt.cancelStyle,N=e.opt.cancelCallback,L=e.opt.doneText,b=e.opt.doneStyle,S=e.opt.doneCallback,I=e.opt.cancelOnly,H=e.opt.noBtn,c=e.opt.position,T=e.opt.closeText,P=e.opt.closeStyle,a=e.opt.closeCallback,U=e.opt.onShow;var E=document.createElement("div");var X,h,K;var g="position:absolute;height:36px;line-height:36px;top:11px;color:#868686;font-weight:normal;";X=G==""?"":'<div class="jasonPopuptitleLeftBtn85js93" style="'+g+"left:10px;"+O+'">'+G+"</div>";h=J==""?"":'<div class="jasonPopuptitleRightBtn85js93" style="'+g+"right:10px;"+M+'">'+J+"</div>";K=T==""?"":'<div class="jasonPopupCloseBtn85js93" style="'+g+"right:10px;"+P+'">'+T+"</div>";var j='<div class="jasonPopupBgDiv847fd8" style="position:fixed;width:100%;height:100%;top:0;left:0; background-color:#666; opacity:0.5; z-index:'+(1000+A.length)+";"+i+'"></div><div class="jasonPopupBox39fj7d" style="position:fixed;display:none;left:0;'+(c=="center"?"top:50%;left:-80%;width:80%;border-radius:5px;":c=="bottom"?"bottom:-100%;left:0;width:100%;":"top:-100%;left:0;width:100%;")+"z-index:"+(1001+A.length)+";color:#454545;background-color:#fff;"+Q+'">'+(R==""?"":'<div class="jasonPopupTitle384jx8" style="padding:15px 10px;line-height:26px;text-align:center;font-weight:bold;font-size:1.125em;position:relative;'+W+'">'+X+R+h+K+"</div>")+'<div class="jasonPopupContent98fd3" style="width:100%;line-height:22px;text-align:center;">'+f+"</div>";if(!H&&c=="center"){j+='<ul class="jasonPopupBtn739jg0s" style="position:relative;z-index:9999;width:100%;color:#007aff;height:45px;line-height:45px;border-top:1px solid #bcbcbc;margin-top:15px;'+V+'">	<li style="float:left;width:50%;text-align:center;'+d+'">'+Y+"</li>"+(I?"":'<li style="float:left;width:50%;box-sizing:border-box;text-align:center;border-left:1px solid #bcbcbc;'+b+'">'+L+'</li><li style="height:0;clear:both;"></li>')+"</ul>"}j+="</div>";E.innerHTML=j;e.popupNode=E;$el=D(E);D("body").append(E);if(!H&&c=="center"){$el.find(".jasonPopupBtn739jg0s li").eq(0).bind("click",function(){N();e.remove(0)});if(!I){$el.find(".jasonPopupBtn739jg0s li").eq(1).bind("click",function(){S();e.remove(0)})}}else{$el.find(".jasonPopupBgDiv847fd8").bind("click",function(){a();e.remove()})}$el.find(".jasonPopuptitleLeftBtn85js93").bind("click",function(){F();e.remove()});$el.find(".jasonPopuptitleRightBtn85js93").bind("click",function(){Z();e.remove()});$el.find(".jasonPopupCloseBtn85js93").bind("click",function(){a();e.remove()});$el.bind("orientationchange",function(){var k=e.windowHeight>480?480:320;e.windowHeight=D.os.android?(window.innerHeight>k?window.innerHeight:k):window.innerHeight;e.positionPopup()});e.inputPosition();D(window).bind("touchmove",function(k){k.preventDefault()});if(I){$el.find(".jasonPopupBtn739jg0s li").eq(0).css({"float":"none","width":"100%","border":"0"})}e.opt.duration=c=="center"?300:600;e.positionPopup();U()},inputPosition:function(){var E=this;D(E.popupNode).find("input").unbind("focus").bind("focus",function(F){if(D.os.android&&E.opt.position!="bottom"){E.isBlurPosition=false;var G=this;var I=G.getBoundingClientRect().bottom;var H=I-((E.windowHeight-260)/2+20)+E.hasPopupPosition;E.positionPopup(H);E.hasPopupPosition=H;D(G).unbind("blur").bind("blur",function(){E.isBlurPosition=true;setTimeout(function(){if(E.isBlurPosition){E.positionPopup();E.hasPopupPosition=0}},100)})}})},lock:function(){this.isLock=1},unlock:function(){this.isLock=0},show:function(){D(this.popupNode).show();D(window).unbind("touchmove").bind("touchmove",function(E){E.preventDefault()})},hide:function(F){var E=this;var H=E.opt.position;var J=isNaN(F)?E.opt.duration:F;var I=D(E.popupNode).find(".jasonPopupBox39fj7d");I.css({"-webkit-transition-duration":J+"ms"});var G=I.css(H=="center"?"top":H);I.css(H=="center"?"top":H,-E.opt.height*E.windowHeight);setTimeout(function(){D(window).unbind("touchmove");D(E.popupNode).hide();I.css({"-webkit-transition-duration":"0ms"});I.css(H=="center"?"top":H,G)},J)},remove:function(F){var E=this;if(!E.isLock){var G=E.opt.position;var I=isNaN(F)?E.opt.duration:F;var H=D(E.popupNode).find(".jasonPopupBox39fj7d");H.css({"-webkit-transition-duration":I+"ms"});H.css(G=="center"?"top":G,-E.opt.height*E.windowHeight);setTimeout(function(){A.splice(0,1);D(window).unbind("touchmove");D(E.popupNode).unbind("orientationchange").remove();if(A.length>0){A[0].show()}},I)}},positionPopup:function(I){var N=this;document.body.scrollTop=window.pageYOffset;var E=I?I:0;var L=N.opt.position;var G=D(N.popupNode).find(".jasonPopupBox39fj7d");var F=G.width();if(F.indexOf("%")>0){F=F.substring(0,F.length-1)/100*window.innerWidth}var H=N.opt.duration;G.css({"left":(window.innerWidth-F)/2,"display":"block","-webkit-transition-duration":H+"ms"});var J=N.windowHeight;var O=N.opt.title==""?0:G.find(".jasonPopupTitle384jx8").offset().height;var K=N.opt.noBtn||L!="center"?0:G.find(".jasonPopupBtn739jg0s").offset().height;var M=(1-N.opt.height)*J;if(G.offset().height>J-M||L=="bottom"){G.find(".jasonPopupContent98fd3").css({"height":(J-O-K-M)+"px","overflow":"hidden"});if(N.opt.isScroll){$el.find(".jasonPopupContent98fd3").jasonScrollbar();N.inputPosition()}}G.css(L=="center"?"top":L,L=="center"?(J-E*2-G.offset().height)/2:L=="bottom"?E:-E)}}})(jason);(function(A){A.fn.jasonSelectDlg=function(B,C){if(!A.isArray(B)){return console.log("first param is not array!")}var G=this,E=A(this);var D=E.data("value");var F=E.html();if(D==""||F==""){D=B[0]["value"];F=B[0]["text"];E.data("value",D);E.html(F)}E.unbind("click").bind("click",function(){D=E.data("value");var I=A.extend({},{liStyle:"",selectedStyle:"",selectedImgUrl:"",selectedImgStyle:"",selectedCallback:function(){},boxStyle:"background:#f5f5f5;",title:"请选择",titleStyle:"background:#f9f9f9;border-bottom:1px solid #ddd;",position:"bottom"},C);var H=!!I.selectedImgUrl?'<img src="'+I.selectedImgUrl+'" style="padding-left:15px;width:13px;vertical-align:middle;position:absolute;top:16px;'+I.selectedImgStyle+'" />':"";var K='<ul class="jasonSelectDlg37dj8">';for(var M in B){var J=B[M];K+='<li data-value="'+J["value"]+'" data-text="'+J["text"]+'" style="line-height:22px; padding:12px 0 12px;font-size:0.9375em; color:#454545; border-bottom:1px solid #eceaea;text-align:center;position:relative;'+I.liStyle+(D==J["value"]?(!I.selectedImgUrl?"color:#00f;font-weight:bold;":"")+I.selectedStyle:"")+'">'+J["text"]+(D==J["value"]?H:"")+"</li>"}K+="</ul>";I=A.extend({},{message:K},I);var L=A.jasonPopup(I);A(".jasonSelectDlg37dj8 li").bind("click",function(){D=A(this).data("value");F=A(this).data("text");E.data("value",D);E.html(F);L.remove();I.selectedCallback({value:D,text:F})})})}})(jason);function alertDlg(B,A){return $.jasonPopup({title:"提示",message:'<div style="margin:0 3%;font-size:0.875em;">'+B+"</div>",cancelText:"确定",cancelCallback:A||function(){},cancelOnly:true})}function confirmDlg(C,B,A){return $.jasonPopup({title:"提示",message:'<div style="margin:0 3%;font-size:0.875em;">'+C+"</div>",doneText:"确定",doneCallback:B||function(){},cancelCallback:A||function(){}})}(function(A){A.fn.jasonImgLazyLoad=function(J){var M=this,E=A(this);var J=A.extend({},{lazy_src:"lazy-src",lazy_style:"lazy-style",container:window,e:"scroll",threshold:0,vertical:true},J);var F=J.lazy_src,L=J.lazy_style,K=A(J.container),B=J.e,N=J.threshold,D=J.vertical;var I=parseInt(D?K.height():K.width());var C=new Array();for(var H=0;H<E.length;H++){if(!!A(E[H]).attr(F)){C.push(E[H])}}var G=function(){for(var P=0;P<C.length;P++){var T=C[P],O=A(C[P]);var U=parseInt(D?window.pageYOffset:window.pageXOffset),Q=parseInt(D?T["y"]:T["x"]);if(U+I+N>Q&&!!O.attr(F)){var S=document.createElement("img");S.src=O.attr(F);S.style.display="none";S.target=O;A("body").append(S);var R=function(V,W){var X=W;X.attr({"src":X.attr(F),"style":X.attr(L)});A(V).remove()};if(!!window.ActiveXObject){S.onreadystatechange=function(){if(this.readyState=="complete"){R(this,this.target)}}}else{S.onload=function(){if(this.complete==true){R(this,this.target)}}}C.splice(P--,1)}}};K=B==="scroll"?K:A(this);K.bind(B,function(){G()});G()}})(jason);(function(A){A.jasonUIBind=A.fn.jasonUIBind=function(){var D=A("[jason-dom]");for(var B=0;B<D.length;B++){var H=A(D[B]);var I=H.attr("jason-dom");if(I=="body"){if(A(".jFoot").length>0){var C=window.innerHeight-A(".jFoot").offset().height}else{var C=window.innerHeight}H.css({"height":C,"margin":"0","padding":"0"})}}var F=A("[jason-js]");for(var B=0;B<F.length;B++){F=A("[jason-js]");var E=A(F[B]);var G=E.attr("jason-js");if(G=="scroll"){E.jasonScrollbar({isShowBar:false})}else{if(G=="scrollbar"){E.jasonScrollbar()}}}}})(jason);